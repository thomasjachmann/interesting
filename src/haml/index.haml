!!!
%html
  %head
    %meta{:charset => 'utf-8'}/
    %meta{:content => 'IE=edge,chrome=1', :"http-equiv" => 'X-UA-Compatible'}/
    %title Interesting - Zinsberechnung
    %link{:href => "css/styles.css", :rel => "stylesheet", :type => "text/css", :media => "all"}

  %body{:"ng-app" => "app", :"ng-controller" => "interestCtrl"}

    %ul.purchases
      %li{:"ng-repeat" => "purchase in purchases", :"ng-click" => "selectPurchase($index) && calculate()", :"ng-class" => "{true:'selected', false:''}[purchase == selectedPurchase]"}
        %span.name {{purchase.name || "-- Unbenannt --"}}
        %span.price {{purchase.price | currency:"&euro; "}}
        %span.addOns {{purchase.addOns | currency:"&euro; "}}
      %li
        %button{:"ng-click" => "addPurchase()"} Add

    %ul.financings
      %li{:"ng-repeat" => "financing in financings", :"ng-click" => "selectFinancing($index) &&Â calculate()", :"ng-class" => "{true:'selected', false:''}[financing == selectedFinancing]"}
        %span.name {{financing.name || "-- Unbenannt --"}}
        %span.capital {{financing.capital | currency:"&euro; "}}
        %span.interestRate {{financing.interestRate | percent}}
        %span.amortizationRate {{financing.amortizationRate | percent}}
      %li
        %button{:"ng-click" => "addFinancing()"} Add

    %table.inputs.purchase
      %caption Immobilienobjekt
      %tr
        %td.label
          %label{:for => "purchaseName"} Name
        %td.input
          %input{:id => "purchaseName", :type => "text", :"ng-model" => "selectedPurchase.name", :"ng-change" => "savePurchase()", :placeholder => "Bitte Namen eingeben"}

      %tr
        %td.label
          %label{:for => "price"}Grunderwerb (bei Bestand inkl. Haus)
        %td.input
          %input#price{:type => "number", :step => "10000", :"ng-model" => "selectedPurchase.price", :"ng-change" => "calculate()"}
        %td.output {{selectedPurchase.price | currency:"&euro; "}}
      %tr
        %td.label
          %label{:for => "addOns"} Zusatzkosten (z. B. Hausbau)
        %td.input
          %input#notary{:type => "number", :step => "10000", :"ng-model" => "selectedPurchase.addOns", :"ng-change" => "calculate()"}
        %td.output {{selectedPurchase.addOns | currency:"&euro; "}}
      %tr.result
        %td.label Gesamtwert
        %td.input
        %td.output {{selectedPurchase.price + selectedPurchase.addOns | currency:"&euro; "}}</td>
      %tr
        %td.label
          %label{:for => "brokerage"} Courtage
        %td.input
          %input#brokerage{:type => "number", :step => "0.05", :"ng-model" => "selectedPurchase.brokerage", :"ng-change" => "calculate()"}
        %td.output {{selectedPurchase.brokerageCost() | currency:"&euro; "}}
      %tr
        %td.label
          %label{:for => "tax"} Grunderwerbsteuer
        %td.input
          %input#tax{:type => "number", :step => "0.5", :"ng-model" => "selectedPurchase.tax", :"ng-change" => "calculate()"}
        %td.output {{selectedPurchase.taxCost() | currency:"&euro; "}}
      %tr
        %td.label
          %label{:for => "notary"} Notarkosten
        %td.input
          %input#notary{:type => "number", :step => "0.5", :"ng-model" => "selectedPurchase.notary", :"ng-change" => "calculate()"}
        %td.output {{selectedPurchase.notaryCost() | currency:"&euro; "}}
      %tr.result
        %td.label Gesamtnebenkosten
        %td.input
        %td.output {{selectedPurchase.taxCost() + selectedPurchase.notaryCost() + selectedPurchase.brokerageCost() | currency:"&euro; "}}
      %tr.result
        %td.label Summe
        %td.input
        %td.output {{selectedPurchase.totalCost() | currency:"&euro; "}}</td>

    %table.inputs.credit
      %caption Finanzierung
      %tr
        %td.label
          %label{:for => "financingName"} Name
        %td.input
          %input{:id => "financingName", :type => "text", :"ng-model" => "selectedFinancing.name", :"ng-change" => "saveFinancing()", :placeholder => "Bitte Namen eingeben"}
      %tr
        %td.label
          %label{:for => "capital"} Eigenkapital
        %td.input
          %input#capital{:type => "number", :step => "10000", :"ng-model" => "selectedFinancing.capital", :"ng-change" => "calculate()"}
      %tr
        %td.label
          %label{:for => "interestRate"} Zinssatz
        %td.input
          %input#interestRate{:type => "number", :step => "0.1", :"ng-model" => "selectedFinancing.interestRate", :"ng-change" => "calculate()"}
      %tr
        %td.label
          %label{:for => "amortizationRate"} Tilgungssatz
        %td.input
          %input#amortizationRate{:type => "number", :step => "0.1", :"ng-model" => "selectedFinancing.amortizationRate", :"ng-change" => "calculate()"}
      %tr
        %td.label Kreditsumme
        %td.output {{credit() | currency:"&euro; "}}
      %tr
        %td.label Monatliche Rate
        %td.output {{monthlyPayment() | currency:"&euro; "}}
      %tr
        %td.label Zahlungsdauer
        %td.output
          %span{:"ng-show" => "months"} {{months.length / 12 | number:0}} Jahre und {{months.length % 12 | number}} Monate
      %tr
        %td.label Gesamtzinsen
        %td.output
          %span{:"ng-show" => "months"} {{totalInterest | currency:"&euro; "}}
      %tr.result
        %td.label Gesamtkosten
        %td.output
          %span{:"ng-show" => "months"} {{totalPayments + selectedPurchase.capital | currency:"&euro; "}}
      %tr
        %td.label davon Nebenkosten
        %td.output
          %span{:"ng-show" => "months"} {{selectedPurchase.taxCost() + selectedPurchase.notaryCost() + selectedPurchase.brokerageCost() + totalInterest | currency:"&euro; "}}

    .processing{:"ng-show" => "processing"} processing...
    %ul#months{:"ng-show" => "months"}
      %li.month{:"ng-repeat" => "month in months", :title => ""}
        {{$index}}: {{month.payment | currency:"&euro; "}}
        %span.interest{:style => "height: {{month.interest / 10 | number:0}}px", :title => "Zins: {{month.interest | currency}}"} {{month.interest | currency:"&euro; "}}
        %span.amortization{:style => "height: {{month.amortization / 10 | number:0}}px", :title => "Tilgung: {{month.amortization | currency}}"} {{month.amortization | currency:"&euro; "}}
        \=>
        %span.balance{:style => "height: {{month.balance / 100 | number:0}}px", :title => "Kreditsumme: {{month.balance | currency}}"} {{month.balance | currency:"&euro; "}}

    %script{:src => "http://ajax.googleapis.com/ajax/libs/angularjs/1.0.4/angular.min.js", :type => "text/javascript"}
    %script{:src => "javascript/app.js", :type => "text/javascript"}
