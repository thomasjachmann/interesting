!!!
%html
  %head
    %meta{:charset => 'utf-8'}/
    %meta{:content => 'IE=edge,chrome=1', :"http-equiv" => 'X-UA-Compatible'}/
    %title Interesting - Zinsberechnung
    %link{:href => "css/styles.css", :rel => "stylesheet", :type => "text/css", :media => "all"}

  %body{:"ng-app" => "app", :"ng-controller" => "interestCtrl"}

    %ul.costs
      %li{:"ng-repeat" => "cost in costs", :"ng-click" => "selectCost($index) && calculate()", :"ng-class" => "{true:'selected', false:''}[cost == selectedCost]"}
        %span.name {{cost.name}}
        %span.price {{cost.price | currency:"&euro; "}}
        %span.addOns {{cost.addOns | currency:"&euro; "}}
      %li
        %input{:type => "text", :"ng-model" => "selectedCost.name", :"ng-change" => "saveCost()", :pattern => ".{1,}"}
        %button{:"ng-click" => "addCost()"} Add

    %ul.payments
      %li{:"ng-repeat" => "payment in payments", :"ng-click" => "selectPayment($index) &&Â calculate()", :"ng-class" => "{true:'selected', false:''}[payment == selectedPayment]"}
        %span.name {{payment.name}}
        %span.capital {{payment.capital | currency:"&euro; "}}
        %span.interestRate {{cost.interestRate | currency:"&euro; "}}
        %span.amortizationRate {{cost.amortizationRate | currency:"&euro; "}}
      %li
        %input{:type => "text", :"ng-model" => "selectedPayment.name", :"ng-change" => "savePayment()", :pattern => ".{1,}"}
        %button{:"ng-click" => "addPayment()"} Add

    %table.inputs.cost
      %caption Preisermittlung
      %tr
        %td.label
          %label{:for => "price"}Grunderwerb (bei Bestand inkl. Haus)
        %td.input
          %input#price{:type => "number", :step => "10000", :"ng-model" => "selectedCost.price", :"ng-change" => "calculate()"}
        %td.output {{selectedCost.price | currency:"&euro; "}}
      %tr
        %td.label
          %label{:for => "addOns"} Zusatzkosten (z. B. Hausbau)
        %td.input
          %input#notary{:type => "number", :step => "10000", :"ng-model" => "selectedCost.addOns", :"ng-change" => "calculate()"}
        %td.output {{selectedCost.addOns | currency:"&euro; "}}
      %tr.result
        %td.label Gesamtwert
        %td.input
        %td.output {{selectedCost.price + selectedCost.addOns | currency:"&euro; "}}</td>
      %tr
        %td.label
          %label{:for => "brokerage"} Courtage
        %td.input
          %input#brokerage{:type => "number", :step => "0.05", :"ng-model" => "selectedCost.brokerage", :"ng-change" => "calculate()"}
        %td.output {{selectedCost.brokerageCost() | currency:"&euro; "}}
      %tr
        %td.label
          %label{:for => "tax"} Grunderwerbsteuer
        %td.input
          %input#tax{:type => "number", :step => "0.5", :"ng-model" => "selectedCost.tax", :"ng-change" => "calculate()"}
        %td.output {{selectedCost.taxCost() | currency:"&euro; "}}
      %tr
        %td.label
          %label{:for => "notary"} Notarkosten
        %td.input
          %input#notary{:type => "number", :step => "0.5", :"ng-model" => "selectedCost.notary", :"ng-change" => "calculate()"}
        %td.output {{selectedCost.notaryCost() | currency:"&euro; "}}
      %tr.result
        %td.label Gesamtnebenkosten
        %td.input
        %td.output {{selectedCost.brokerageCost() + selectedCost.taxCost() + selectedCost.notaryCost() | currency:"&euro; "}}
      %tr.result
        %td.label Summe
        %td.input
        %td.output {{selectedCost.cost() | currency:"&euro; "}}</td>

    %table.inputs.credit
      %caption Zinsberechnung
      %tr
        %td.label
          %label{:for => "capital"} Eigenkapital
        %td.input
          %input#capital{:type => "number", :step => "10000", :"ng-model" => "selectedPayment.capital", :"ng-change" => "calculate()"}
      %tr
        %td.label
          %label{:for => "interestRate"} Zinssatz
        %td.input
          %input#interestRate{:type => "number", :step => "0.1", :"ng-model" => "selectedPayment.interestRate", :"ng-change" => "calculate()"}
      %tr
        %td.label
          %label{:for => "amortizationRate"} Tilgungssatz
        %td.input
          %input#amortizationRate{:type => "number", :step => "0.1", :"ng-model" => "selectedPayment.amortizationRate", :"ng-change" => "calculate()"}
      %tr
        %td.label Kreditsumme
        %td.output {{credit() | currency:"&euro; "}}
      %tr
        %td.label Monatliche Rate
        %td.output {{payment() | currency:"&euro; "}}
      %tr
        %td.label Zahlungsdauer
        %td.output
          %span{:"ng-show" => "months"} {{months.length / 12 | number:0}} Jahre und {{months.length % 12 | number}} Monate
      %tr
        %td.label Gesamtzinsen
        %td.output
          %span{:"ng-show" => "months"} {{totalInterest | currency:"&euro; "}}
      %tr.result
        %td.label Gesamtkosten
        %td.output
          %span{:"ng-show" => "months"} {{totalPayments + selectedCost.capital | currency:"&euro; "}}
      %tr
        %td.label davon Nebenkosten
        %td.output
          %span{:"ng-show" => "months"} {{selectedCost.brokerageCost() + selectedCost.taxCost() + selectedCost.notaryCost() + totalInterest | currency:"&euro; "}}

    .processing{:"ng-show" => "processing"} processing...
    %ul#months{:"ng-show" => "months"}
      %li.month{:"ng-repeat" => "month in months", :title => ""}
        {{$index}}: {{month.payment | currency:"&euro; "}}
        %span.interest{:style => "height: {{month.interest / 10 | number:0}}px", :title => "Zins: {{month.interest | currency}}"} {{month.interest | currency:"&euro; "}}
        %span.amortization{:style => "height: {{month.amortization / 10 | number:0}}px", :title => "Tilgung: {{month.amortization | currency}}"} {{month.amortization | currency:"&euro; "}}
        \=>
        %span.balance{:style => "height: {{month.balance / 100 | number:0}}px", :title => "Kreditsumme: {{month.balance | currency}}"} {{month.balance | currency:"&euro; "}}

    %script{:src => "http://ajax.googleapis.com/ajax/libs/angularjs/1.0.4/angular.min.js", :type => "text/javascript"}
    %script{:src => "javascript/app.js", :type => "text/javascript"}
